Vue.use(VueMaterial);var APP=new Vue({el:"#app",data:{allOrderList:{array:[],map:{}},currentOrderList:{items:{array:[],map:{}},id:"",selectedItemId:""},newOrderListDialog:{name:""},renameOrderListDialog:{item:null,oldName:"",newName:""},newOrderItemDialog:{name:"",amount:1,brand:"",note:""},editOrderContent:{item:null,name:"",amount:1,brand:"",note:""}},computed:{hasOrderList:function(){return null!==this.allOrderList.array&&this.allOrderList.array.length>0},currentOrderListName:function(){var e=this.currentOrderList.id;return e&&this.allOrderList.map?this.allOrderList.map[e].name:""}},methods:{selectOrderList:function(e){var r=this,t=r.currentOrderList;e!==t.id&&(t.id=e,t.selectedItemId=null,console.log("selectOrderList: ",e),FB.listenToOrderListChange(e,function(e){console.log("items",e);var n=[],i;for(var a in e)e.hasOwnProperty(a)&&(i=e[a],i.removable&&n.push(i));console.log(n),r.currentOrderList.items.array=n.sort(function(e,r){return e.createdDate>r.createdDate?-1:e.createdDate<r.createdDate?1:0}),r.currentOrderList.items.map=e,console.log(t)}),e||(t.items.array=[],t.items.map={}))},removeOrderList:function(e){if(e.removable){var r=this.currentOrderList,t=r.id,n=this.allOrderList.array;if(e.id===t){var i=n.indexOf(e);i===n.length-1?i-=1:i+=1,i>=0?this.selectOrderList(n[i].id):this.selectOrderList(null)}FB.removeOrderList(e.id)}},cloneOrderList:function(e,r){e.removable&&FB.cloneOrderList(e,r)},renameOrderList:function(e,r){e.removable&&FB.renameOrderList(e,r)},addNewOrderList:function(e){FB.newOrderList(e),this.newOrderListDialog.name=""},removeOrderItem:function(e){console.log("remove",e),FB.removeOrderItem(e.listId,e.id)},addOrderItem:function(){var e=this.newOrderItemDialog;FB.addOrderItem(this.currentOrderList.id,{name:e.name,brand:e.brand,amount:e.amount,note:e.note,check:!1}),e.name="",e.brand="",e.note="",e.amount=1},selectOrderItem:function(e){var r=this.currentOrderList,t=r.items.map[e];r.selectedItemId=e,this.editOrderContent={name:t.name,amount:t.amount,brand:t.brand,note:t.note}},cancelEditOrderItem:function(e){var r=this.editOrderContent;e.name=r.name,e.amount=r.amount,e.brand=r.brand,e.note=r.note,this.currentOrderList.selectedItemId=""},saveEditOrderItem:function(e){FB.addOrderItem(e.listId,e),this.currentOrderList.selectedItemId=""},openDialog:function(e){this.$refs[e].open()},closeDialog:function(e){this.$refs[e].close()}}}),firstInit=!0,FB=(new Firebase).init(function(e){var r=[],t;for(var n in e)t=e[n],t.removable&&r.push(t);APP.allOrderList.array=r.sort(function(e,r){return e.createdDate>r.createdDate?-1:e.createdDate<r.createdDate?1:0}),APP.allOrderList.map=e,(firstInit||!APP.currentOrderList.id)&&r&&r.length&&(APP.selectOrderList(r[0].id),firstInit=!1)});